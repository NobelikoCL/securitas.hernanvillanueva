{% extends "pwa_base.html" %}
{#% load i18n %#} {# Cargar la librería de internacionalización #}

{% block title %}{{ titulo_pagina }} - Gestor de Flota{% endblock %}

{% block content %}
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1>{{ titulo_pagina }}</h1>
        <a href="{% url 'flota_app:vehiculo_create' %}" class="btn btn-primary">Añadir Vehículo</a>
    </div>

    {% if vehiculos %}
        <table class="table table-striped table-bordered">
            <thead class="thead-light">
                <tr>
                    <th>Patente</th>
                    <th>Marca</th>
                    <th>Modelo</th>
                    <th>Año</th>
                    <th>Kilometraje</th>
                    <th>En Reparación</th>
                    <th>Instalación Base</th>
                    <th>Centro de Costo</th>
                    <th>Cliente</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for vehiculo in vehiculos %}
                    <tr>
                        <td>{{ vehiculo.patente }}</td>
                        <td>{{ vehiculo.marca }}</td>
                        <td>{{ vehiculo.modelo }}</td>
                        <td>{{ vehiculo.año }}</td>
                        <td>{{ vehiculo.kilometraje }}&nbsp;km</td> {# &nbsp; para espacio no rompible #}
                        <td>{% if vehiculo.en_reparacion %}Sí{% else %}No{% endif %}</td>
                        <td>
                            {% if vehiculo.instalacion_base %}
                                {{ vehiculo.instalacion_base.nombre }}
                            {% else %}
                                <span class="text-muted">N/A</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if vehiculo.instalacion_base and vehiculo.instalacion_base.centro_costo %}
                                {{ vehiculo.instalacion_base.centro_costo.nombre }}
                            {% else %}
                                <span class="text-muted">N/A</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if vehiculo.instalacion_base and vehiculo.instalacion_base.centro_costo and vehiculo.instalacion_base.centro_costo.cliente %}
                                {{ vehiculo.instalacion_base.centro_costo.cliente.nombre }}
                            {% else %}
                                <span class="text-muted">N/A</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'flota_app:vehiculo_update' pk=vehiculo.pk %}" class="btn btn-sm btn-info">Editar</a>
                            <a href="{% url 'flota_app:vehiculo_delete' pk=vehiculo.pk %}" class="btn btn-sm btn-danger">Eliminar</a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="alert alert-info">No hay vehículos registrados.</p>
        <a href="{% url 'flota_app:vehiculo_create' %}" class="btn btn-primary mt-2">Añadir el primer vehículo</a>
    {% endif %}
{% endblock %}
